(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[529],{5280:function(e,a,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/setup/step4",function(){return s(4234)}])},5385:function(e,a,s){"use strict";s.d(a,{Z:function(){return WizardLayout}});var t=s(5893),i=s(5379),n=s.n(i);s(7294);var r=s(1163);function WizardLayout(e){let{currentStep:a,steps:s,children:i,onNext:o,onPrevious:l,onCancel:c,nextDisabled:f=!1,nextLabel:d="Next",showPrevious:x=!0,showNext:b=!0}=e,m=(0,r.useRouter)(),handleCancel=()=>{c?c():m.push("/embedded/chat"+window.location.search)},p=s.find(e=>e.id===a),g=s.findIndex(e=>e.id===a),h=(g+1)/s.length*100;return(0,t.jsxs)("div",{className:"jsx-46943cbf7e21d25f wizard-layout",children:[(0,t.jsxs)("div",{className:"jsx-46943cbf7e21d25f wizard-header",children:[(0,t.jsxs)("div",{className:"jsx-46943cbf7e21d25f header-content",children:[(0,t.jsx)("h1",{className:"jsx-46943cbf7e21d25f wizard-title",children:"Tenant Setup"}),(0,t.jsx)("button",{onClick:handleCancel,title:"Cancel setup","aria-label":"Cancel setup",className:"jsx-46943cbf7e21d25f cancel-button",children:(0,t.jsx)("svg",{viewBox:"0 0 24 24",width:"20",height:"20",className:"jsx-46943cbf7e21d25f",children:(0,t.jsx)("path",{fill:"currentColor",d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z",className:"jsx-46943cbf7e21d25f"})})})]}),(0,t.jsxs)("div",{className:"jsx-46943cbf7e21d25f progress-container",children:[(0,t.jsx)("div",{className:"jsx-46943cbf7e21d25f progress-bar",children:(0,t.jsx)("div",{style:{width:"".concat(h,"%")},className:"jsx-46943cbf7e21d25f progress-fill"})}),(0,t.jsxs)("div",{className:"jsx-46943cbf7e21d25f progress-text",children:["Step ",a," of ",s.length]})]})]}),(0,t.jsx)("div",{className:"jsx-46943cbf7e21d25f step-navigation",children:s.map((e,s)=>(0,t.jsxs)("div",{className:"jsx-46943cbf7e21d25f "+"step-item ".concat(e.id===a?"active":""," ").concat(e.completed?"completed":""),children:[(0,t.jsx)("div",{className:"jsx-46943cbf7e21d25f step-indicator",children:e.completed?(0,t.jsx)("svg",{viewBox:"0 0 24 24",width:"16",height:"16",className:"jsx-46943cbf7e21d25f",children:(0,t.jsx)("path",{fill:"currentColor",d:"M9,20.42L2.79,14.21L5.62,11.38L9,14.77L18.88,4.88L21.71,7.71L9,20.42Z",className:"jsx-46943cbf7e21d25f"})}):(0,t.jsx)("span",{className:"jsx-46943cbf7e21d25f",children:e.id})}),(0,t.jsxs)("div",{className:"jsx-46943cbf7e21d25f step-content",children:[(0,t.jsx)("div",{className:"jsx-46943cbf7e21d25f step-title",children:e.title}),(0,t.jsx)("div",{className:"jsx-46943cbf7e21d25f step-description",children:e.description})]})]},e.id))}),p&&(0,t.jsxs)("div",{className:"jsx-46943cbf7e21d25f current-step-header",children:[(0,t.jsx)("h2",{className:"jsx-46943cbf7e21d25f",children:p.title}),(0,t.jsx)("p",{className:"jsx-46943cbf7e21d25f",children:p.description})]}),(0,t.jsx)("div",{className:"jsx-46943cbf7e21d25f wizard-content",children:i}),(0,t.jsxs)("div",{className:"jsx-46943cbf7e21d25f wizard-navigation",children:[x&&a>1&&(0,t.jsxs)("button",{onClick:l,className:"jsx-46943cbf7e21d25f nav-button secondary",children:[(0,t.jsx)("svg",{viewBox:"0 0 24 24",width:"16",height:"16",className:"jsx-46943cbf7e21d25f",children:(0,t.jsx)("path",{fill:"currentColor",d:"M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z",className:"jsx-46943cbf7e21d25f"})}),"Previous"]}),(0,t.jsx)("div",{className:"jsx-46943cbf7e21d25f nav-spacer"}),(0,t.jsx)("button",{onClick:handleCancel,className:"jsx-46943cbf7e21d25f nav-button cancel",children:"Cancel"}),b&&(0,t.jsxs)("button",{onClick:o,disabled:f,className:"jsx-46943cbf7e21d25f nav-button primary",children:[d,(0,t.jsx)("svg",{viewBox:"0 0 24 24",width:"16",height:"16",className:"jsx-46943cbf7e21d25f",children:(0,t.jsx)("path",{fill:"currentColor",d:"M4,11V13H16L10.5,18.5L11.92,19.92L19.84,12L11.92,4.08L10.5,5.5L16,11H4Z",className:"jsx-46943cbf7e21d25f"})})]})]}),(0,t.jsx)(n(),{id:"46943cbf7e21d25f",children:".wizard-layout.jsx-46943cbf7e21d25f{min-height:100vh;background:#000;color:#fff;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.wizard-header.jsx-46943cbf7e21d25f{background:rgba(255,255,255,.02);border-bottom:1px solid rgba(255,255,255,.1);padding:1.5rem}.header-content.jsx-46943cbf7e21d25f{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin-bottom:1rem}.wizard-title.jsx-46943cbf7e21d25f{font-size:1.5rem;font-weight:600;margin:0}.cancel-button.jsx-46943cbf7e21d25f{width:36px;height:36px;border:none;-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;background:rgba(255,255,255,.1);color:rgba(255,255,255,.7);cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-transition:all.2s ease;-moz-transition:all.2s ease;-o-transition:all.2s ease;transition:all.2s ease}.cancel-button.jsx-46943cbf7e21d25f:hover{background:rgba(239,68,68,.2);color:#fca5a5}.progress-container.jsx-46943cbf7e21d25f{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:1rem}.progress-bar.jsx-46943cbf7e21d25f{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;height:4px;background:rgba(255,255,255,.1);-webkit-border-radius:2px;-moz-border-radius:2px;border-radius:2px;overflow:hidden}.progress-fill.jsx-46943cbf7e21d25f{height:100%;background:-webkit-linear-gradient(left,#007bff,#0056b3);background:-moz-linear-gradient(left,#007bff,#0056b3);background:-o-linear-gradient(left,#007bff,#0056b3);background:linear-gradient(90deg,#007bff,#0056b3);-webkit-transition:width.3s ease;-moz-transition:width.3s ease;-o-transition:width.3s ease;transition:width.3s ease}.progress-text.jsx-46943cbf7e21d25f{font-size:.875rem;color:rgba(255,255,255,.7);white-space:nowrap}.step-navigation.jsx-46943cbf7e21d25f{padding:1.5rem;border-bottom:1px solid rgba(255,255,255,.1);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:2rem;overflow-x:auto}.step-item.jsx-46943cbf7e21d25f{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:.75rem;min-width:200px;opacity:.5;-webkit-transition:opacity.2s ease;-moz-transition:opacity.2s ease;-o-transition:opacity.2s ease;transition:opacity.2s ease}.step-item.active.jsx-46943cbf7e21d25f{opacity:1}.step-item.completed.jsx-46943cbf7e21d25f{opacity:.8}.step-indicator.jsx-46943cbf7e21d25f{width:32px;height:32px;-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;background:rgba(255,255,255,.1);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;font-weight:600;font-size:.875rem;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0}.step-item.active.jsx-46943cbf7e21d25f .step-indicator.jsx-46943cbf7e21d25f{background:#007bff;color:#fff}.step-item.completed.jsx-46943cbf7e21d25f .step-indicator.jsx-46943cbf7e21d25f{background:#10b981;color:#fff}.step-content.jsx-46943cbf7e21d25f{min-width:0}.step-title.jsx-46943cbf7e21d25f{font-weight:600;font-size:.875rem;margin-bottom:.25rem}.step-description.jsx-46943cbf7e21d25f{font-size:.75rem;color:rgba(255,255,255,.6);line-height:1.3}.current-step-header.jsx-46943cbf7e21d25f{padding:2rem 1.5rem 1rem;border-bottom:1px solid rgba(255,255,255,.1)}.current-step-header.jsx-46943cbf7e21d25f h2.jsx-46943cbf7e21d25f{font-size:1.25rem;font-weight:600;margin:0 0 .5rem 0}.current-step-header.jsx-46943cbf7e21d25f p.jsx-46943cbf7e21d25f{color:rgba(255,255,255,.7);margin:0;line-height:1.5}.wizard-content.jsx-46943cbf7e21d25f{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;padding:2rem 1.5rem;overflow-y:auto}.wizard-navigation.jsx-46943cbf7e21d25f{padding:1.5rem;border-top:1px solid rgba(255,255,255,.1);display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:1rem}.nav-spacer.jsx-46943cbf7e21d25f{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1}.nav-button.jsx-46943cbf7e21d25f{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:.5rem;padding:.75rem 1.5rem;border:1px solid rgba(255,255,255,.2);-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;font-weight:600;font-size:.875rem;cursor:pointer;-webkit-transition:all.2s ease;-moz-transition:all.2s ease;-o-transition:all.2s ease;transition:all.2s ease}.nav-button.primary.jsx-46943cbf7e21d25f{background:#007bff;border-color:#007bff;color:#fff}.nav-button.primary.jsx-46943cbf7e21d25f:hover:not(:disabled){background:#0056b3;border-color:#0056b3;-webkit-transform:translatey(-1px);-moz-transform:translatey(-1px);-ms-transform:translatey(-1px);-o-transform:translatey(-1px);transform:translatey(-1px)}.nav-button.secondary.jsx-46943cbf7e21d25f{background:rgba(255,255,255,.1);color:#fff}.nav-button.secondary.jsx-46943cbf7e21d25f:hover{background:rgba(255,255,255,.2);-webkit-transform:translatey(-1px);-moz-transform:translatey(-1px);-ms-transform:translatey(-1px);-o-transform:translatey(-1px);transform:translatey(-1px)}.nav-button.cancel.jsx-46943cbf7e21d25f{background:transparent;color:rgba(255,255,255,.7)}.nav-button.cancel.jsx-46943cbf7e21d25f:hover{background:rgba(239,68,68,.1);border-color:rgba(239,68,68,.3);color:#fca5a5}.nav-button.jsx-46943cbf7e21d25f:disabled{opacity:.5;cursor:not-allowed;-webkit-transform:none!important;-moz-transform:none!important;-ms-transform:none!important;-o-transform:none!important;transform:none!important}@media(max-width:768px){.wizard-header.jsx-46943cbf7e21d25f,.wizard-content.jsx-46943cbf7e21d25f,.wizard-navigation.jsx-46943cbf7e21d25f{padding:1rem}.step-navigation.jsx-46943cbf7e21d25f{padding:1rem;gap:1rem}.step-item.jsx-46943cbf7e21d25f{min-width:150px}.current-step-header.jsx-46943cbf7e21d25f{padding:1.5rem 1rem .75rem}.wizard-navigation.jsx-46943cbf7e21d25f{-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;gap:.75rem}.nav-button.jsx-46943cbf7e21d25f{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1;min-width:120px;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center}}"})]})}},2905:function(e,a,s){"use strict";s.d(a,{OY:function(){return WebAIApi},Pf:function(){return createTenantSetupApi}});var t=s(3454);let WebAIApi=class WebAIApi{debugLog(){for(var e=arguments.length,a=Array(e),s=0;s<e;s++)a[s]=arguments[s];this.config.debug&&console.log("[WebAI API]",...a)}updateConfig(e){this.config={...this.config,...e},this.debugLog("Config updated:",this.config)}async *chat(e){let a=e[e.length-1];if(!a||"user"!==a.role)throw Error("Last message must be from user");this.abortController&&this.abortController.abort(),this.abortController=new AbortController;let s={message:a.content,session_id:this.config.sessionId,use_redis_conversations:!0,use_rag:this.config.useRAG,rag_top_k:this.config.ragTopK};this.debugLog("Sending chat request:",s);try{var t,i,n,r;let e=await fetch("".concat(this.config.apiUrl,"/chat/stream"),{method:"POST",headers:{"Content-Type":"application/json","X-Tenant-ID":this.config.tenantId},body:JSON.stringify(s),signal:this.abortController.signal});if(!e.ok){let a=await e.text().catch(()=>"Unknown error"),s="HTTP ".concat(e.status,": ").concat(e.statusText);try{let e=JSON.parse(a);s=e.detail||s}catch(e){a&&(s=a)}throw Error(s)}let a=null===(t=e.body)||void 0===t?void 0:t.getReader();if(!a)throw Error("No response body available");let o=new TextDecoder,l="",c="";for(;;){let e;let{done:s,value:t}=await a.read();if(s)break;for(l+=o.decode(t,{stream:!0});-1!==(e=l.indexOf("\n"));){let a=l.slice(0,e).trimEnd();if(l=l.slice(e+1),!a.startsWith("data: "))continue;let s=a.slice(6).trim();if("[DONE]"===s){this.debugLog("Stream completed, full response length:",c.length),yield{role:"assistant",content:"",delta:!1,finished:!0};return}try{let e=JSON.parse(s);if(e.error)throw Error(e.error);let a=null===(r=e.choices)||void 0===r?void 0:null===(n=r[0])||void 0===n?void 0:null===(i=n.delta)||void 0===i?void 0:i.content;a&&(c+=a,this.debugLog("Received delta:",a.length,"chars"),yield{role:"assistant",content:a,delta:!0})}catch(e){!this.config.debug||e instanceof SyntaxError||console.warn("[WebAI API] Parse error:",e,"for data:",s)}}}}catch(e){if(e instanceof Error){if("AbortError"===e.name){this.debugLog("Request aborted");return}this.debugLog("Chat error:",e.message),yield{role:"assistant",content:"",delta:!1,error:e.message}}else this.debugLog("Unknown error:",e),yield{role:"assistant",content:"",delta:!1,error:"An unknown error occurred"}}finally{this.abortController=null}}cancel(){this.abortController&&(this.abortController.abort(),this.abortController=null,this.debugLog("Request cancelled"))}async testConnection(){try{let e=await fetch("".concat(this.config.apiUrl,"/health"),{method:"GET",headers:{"X-Tenant-ID":this.config.tenantId}}),a=e.ok;return this.debugLog("Connection test:",a?"SUCCESS":"FAILED"),a}catch(e){return this.debugLog("Connection test error:",e),!1}}async getTenantConfig(){try{let e=await fetch("".concat(this.config.apiUrl,"/tenants/").concat(this.config.tenantId),{method:"GET",headers:{"X-Tenant-ID":this.config.tenantId}});if(!e.ok)throw Error("Failed to get tenant config: ".concat(e.statusText));let a=await e.json();return this.debugLog("Tenant config:",a),a}catch(e){throw this.debugLog("Failed to get tenant config:",e),e}}async getConversationHistory(){try{let e=await fetch("".concat(this.config.apiUrl,"/conversations/").concat(this.config.sessionId),{method:"GET",headers:{"X-Tenant-ID":this.config.tenantId}});if(!e.ok)return this.debugLog("No conversation history available"),[];let a=await e.json();return this.debugLog("Loaded conversation history:",a.length,"messages"),a}catch(e){return this.debugLog("Failed to load conversation history:",e),[]}}async clearConversationHistory(){try{let e=await fetch("".concat(this.config.apiUrl,"/conversations/").concat(this.config.sessionId),{method:"DELETE",headers:{"X-Tenant-ID":this.config.tenantId}});if(!e.ok)throw Error("Failed to clear conversation: ".concat(e.statusText));this.debugLog("Conversation history cleared")}catch(e){throw this.debugLog("Failed to clear conversation history:",e),e}}constructor(e){this.abortController=null,this.config=e,this.debugLog("WebAI API initialized with config:",e)}};let WebAITenantSetupApi=class WebAITenantSetupApi extends WebAIApi{async registerTenant(e){try{let a=t.env.NEXT_PUBLIC_WEBAI_ADMIN_KEY;if(!a)throw Error("NEXT_PUBLIC_WEBAI_ADMIN_KEY environment variable is required");let s=await fetch("".concat(this.config.apiUrl,"/register-tenant"),{method:"POST",headers:{"Content-Type":"application/json","X-Admin-Key":a},body:JSON.stringify(e)});if(!s.ok){let e=await s.text().catch(()=>"Unknown error"),a="HTTP ".concat(s.status,": ").concat(s.statusText);try{let s=JSON.parse(e);a=s.detail||a}catch(s){e&&(a=e)}throw Error(a)}let i=await s.json();return this.debugLog("Tenant registered successfully:",i),i}catch(e){throw this.debugLog("Failed to register tenant:",e),e}}async validateOpenRouterKey(e){try{let a=await fetch("".concat(this.config.apiUrl,"/api-keys/validate"),{method:"POST",headers:{"Content-Type":"application/json","X-Tenant-ID":this.config.tenantId},body:JSON.stringify({api_key:e,provider:"openrouter"})});if(!a.ok)throw Error("Validation failed: ".concat(a.statusText));let s=await a.json();return this.debugLog("API key validation result:",s),s}catch(e){throw this.debugLog("Failed to validate API key:",e),e}}async getSystemCapabilities(){try{let e=await fetch("".concat(this.config.apiUrl,"/rag/processing-capabilities"),{method:"GET",headers:{"X-Tenant-ID":this.config.tenantId}});if(!e.ok)throw Error("Failed to get capabilities: ".concat(e.statusText));let a=await e.json();return this.debugLog("System capabilities:",a),a}catch(e){throw this.debugLog("Failed to get system capabilities:",e),e}}async analyzeFile(e){try{let a=new FormData;a.append("file",e),a.append("tenant_id",this.config.tenantId);let s=await fetch("".concat(this.config.apiUrl,"/rag/analyze-file"),{method:"POST",headers:{"X-Tenant-ID":this.config.tenantId},body:a});if(!s.ok)throw Error("File analysis failed: ".concat(s.statusText));let t=await s.json();return this.debugLog("File analysis result:",t),t}catch(e){throw this.debugLog("Failed to analyze file:",e),e}}async *processFileStreaming(e,a){try{var s;let t=new FormData;t.append("file",e),t.append("tenant_id",this.config.tenantId),t.append("schema_config",JSON.stringify(a));let i=await fetch("".concat(this.config.apiUrl,"/rag/ingest-file-streaming"),{method:"POST",headers:{"X-Tenant-ID":this.config.tenantId},body:t});if(!i.ok)throw Error("File processing failed: ".concat(i.statusText));let n=null===(s=i.body)||void 0===s?void 0:s.getReader();if(!n)throw Error("No response body available");let r=new TextDecoder,o="";for(;;){let e;let{done:a,value:s}=await n.read();if(a)break;for(o+=r.decode(s,{stream:!0});-1!==(e=o.indexOf("\n"));){let a=o.slice(0,e).trimEnd();if(o=o.slice(e+1),!a.startsWith("data: "))continue;let s=a.slice(6).trim();if("[DONE]"===s){this.debugLog("File processing completed");return}try{let e=JSON.parse(s);this.debugLog("Processing progress:",e),yield e}catch(e){this.config.debug&&console.warn("[WebAI API] Parse error:",e,"for data:",s)}}}}catch(e){throw this.debugLog("Failed to process file:",e),e}}async processFileAsync(e,a){try{let s=new FormData;s.append("file",e),s.append("tenant_id",this.config.tenantId),s.append("schema_config",JSON.stringify(a));let t=await fetch("".concat(this.config.apiUrl,"/rag/ingest-file-async"),{method:"POST",headers:{"X-Tenant-ID":this.config.tenantId},body:s});if(!t.ok)throw Error("Async processing failed: ".concat(t.statusText));let i=await t.json();return this.debugLog("Async processing started:",i),i}catch(e){throw this.debugLog("Failed to start async processing:",e),e}}async getProcessingStatus(e){try{let a=await fetch("".concat(this.config.apiUrl,"/rag/job-status/").concat(e),{method:"GET",headers:{"X-Tenant-ID":this.config.tenantId}});if(!a.ok)throw Error("Failed to get job status: ".concat(a.statusText));let s=await a.json();return this.debugLog("Job status:",s),s}catch(e){throw this.debugLog("Failed to get job status:",e),e}}};function createTenantSetupApi(){let e=new URLSearchParams(window.location.search),a={apiUrl:"https://web3ai-backend-v65-api-180395924844.us-central1.run.app",tenantId:e.get("tenant")||"setup",sessionId:e.get("session")||"setup",useRAG:!1,ragTopK:4,debug:"true"===e.get("debug")};return new WebAITenantSetupApi(a)}},4234:function(e,a,s){"use strict";s.r(a);var t=s(5893),i=s(5379),n=s.n(i),r=s(7294),o=s(1163),l=s(9008),c=s.n(l),f=s(5385),d=s(2905);console.log("[DEBUG] step4.tsx loaded - imports verified");let x=[{id:1,title:"Welcome",description:"Introduction to setup",path:"/setup/step1",completed:!0},{id:2,title:"Tenant Registration",description:"Configure your tenant settings",path:"/setup/step2",completed:!0},{id:3,title:"System Capabilities",description:"Review available features",path:"/setup/step3",completed:!0},{id:4,title:"File Analysis",description:"Upload and analyze files",path:"/setup/step4"},{id:5,title:"File Processing",description:"Configure processing pipeline",path:"/setup/step5"}];a.default=function(){let e=(0,o.useRouter)(),a=(0,r.useRef)(null),[s,i]=(0,r.useState)(null),[l,b]=(0,r.useState)([]),[m,p]=(0,r.useState)(!1),[g,h]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=(0,d.Pf)();i(e)},[]);let handleFiles=e=>{let a=e.filter(e=>validateFile(e));if(a.length>0){let e=a.map(e=>({file:e}));b(a=>[...a,...e]),a.forEach((e,s)=>{let t=l.length+s;console.log("[DEBUG] Starting analysis for file ".concat(s+1,"/").concat(a.length,": ").concat(e.name," at index ").concat(t)),analyzeFile(e,t)})}},validateFile=e=>e.size>104857600?(alert('File "'.concat(e.name,'" is too large. Maximum size is 100MB.')),!1):!!(["application/pdf","text/plain","text/markdown","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","text/csv","application/json","text/html","application/rtf"].includes(e.type)||e.name.match(/\.(txt|md|pdf|doc|docx|csv|json|html|rtf)$/i))||(alert('File "'.concat(e.name,'" is not a supported format.')),!1),analyzeFile=async(e,a)=>{if(!s){console.error("[DEBUG] No API available for file analysis");return}console.log("[DEBUG] Analyzing file: ".concat(e.name," (").concat(e.size," bytes) at index ").concat(a)),b(e=>e.map((e,s)=>s===a?{...e,isAnalyzing:!0,error:void 0}:e)),h(!0);try{let t=await s.analyzeFile(e);console.log("[DEBUG] Analysis completed for ".concat(e.name,":"),t),b(e=>e.map((e,s)=>s===a?{...e,analysis:t,isAnalyzing:!1}:e))}catch(s){console.error("[DEBUG] File analysis failed for ".concat(e.name,":"),s),b(e=>e.map((e,t)=>t===a?{...e,isAnalyzing:!1,error:s instanceof Error?s.message:"Analysis failed"}:e))}finally{h(!1)}},removeFile=e=>{b(a=>a.filter((a,s)=>s!==e))},retryAnalysis=e=>{let a=l[e];a&&analyzeFile(a.file,e)},formatFileSize=e=>{if(0===e)return"0 Bytes";let a=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,a)).toFixed(2))+" "+["Bytes","KB","MB","GB"][a]},formatProcessingTime=e=>(e.includes("seconds")||e.includes("minutes"),e),u=l.some(e=>e.analysis);return l.some(e=>e.error),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(c(),{children:(0,t.jsx)("title",{children:"File Analysis - WebAI Setup"})}),(0,t.jsxs)(f.Z,{currentStep:4,steps:x,onNext:()=>{let a=l.filter(e=>e.analysis).map(e=>({filename:e.file.name,size:e.file.size,type:e.file.type,analysis:e.analysis}));console.log("[DEBUG] Saving analysis results for",a.length,"files to session storage"),sessionStorage.setItem("fileAnalysisResults",JSON.stringify(a)),e.push("/setup/step5"+window.location.search)},onPrevious:()=>{e.push("/setup/step3"+window.location.search)},nextDisabled:!u||g,nextLabel:"Continue to Processing",children:[(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 file-analysis-page",children:[(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 intro-section",children:[(0,t.jsx)("h3",{className:"jsx-33a132a3ce0f70f1",children:"File Analysis"}),(0,t.jsx)("p",{className:"jsx-33a132a3ce0f70f1",children:"Upload your documents to analyze their content and get processing recommendations."})]}),(0,t.jsxs)("div",{onDragOver:e=>{e.preventDefault(),p(!0)},onDragLeave:e=>{e.preventDefault(),p(!1)},onDrop:e=>{e.preventDefault(),p(!1);let a=Array.from(e.dataTransfer.files);console.log("[DEBUG] Files dropped:",a.length,"files"),handleFiles(a)},onClick:()=>{var e;return null===(e=a.current)||void 0===e?void 0:e.click()},className:"jsx-33a132a3ce0f70f1 "+"upload-area ".concat(m?"drag-over":""),children:[(0,t.jsx)("div",{className:"jsx-33a132a3ce0f70f1 upload-icon",children:"\uD83D\uDCC1"}),(0,t.jsx)("h4",{className:"jsx-33a132a3ce0f70f1",children:"Drop files here or click to browse"}),(0,t.jsx)("p",{className:"jsx-33a132a3ce0f70f1",children:"Supports PDF, TXT, DOCX, MD, CSV, JSON, HTML, RTF files up to 100MB"}),(0,t.jsx)("input",{ref:a,type:"file",multiple:!0,accept:".pdf,.txt,.docx,.doc,.md,.csv,.json,.html,.rtf",onChange:e=>{let a=Array.from(e.target.files||[]);console.log("[DEBUG] Files selected:",a.length,"files"),handleFiles(a)},style:{display:"none"},className:"jsx-33a132a3ce0f70f1"})]}),l.length>0&&(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 files-section",children:[(0,t.jsxs)("h4",{className:"jsx-33a132a3ce0f70f1",children:["Uploaded Files (",l.length,")"]}),(0,t.jsx)("div",{className:"jsx-33a132a3ce0f70f1 files-list",children:l.map((e,a)=>(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 file-item",children:[(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 file-header",children:[(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 file-info",children:[(0,t.jsx)("div",{className:"jsx-33a132a3ce0f70f1 file-name",children:e.file.name}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 file-meta",children:[formatFileSize(e.file.size)," • ",e.file.type||"Unknown type"]})]}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 file-actions",children:[e.isAnalyzing&&(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analyzing-indicator",children:[(0,t.jsx)("svg",{viewBox:"0 0 24 24",className:"jsx-33a132a3ce0f70f1 spinner",children:(0,t.jsxs)("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"2",fill:"none",strokeDasharray:"31.416",strokeDashoffset:"31.416",className:"jsx-33a132a3ce0f70f1",children:[(0,t.jsx)("animate",{attributeName:"stroke-dasharray",dur:"2s",values:"0 31.416;15.708 15.708;0 31.416",repeatCount:"indefinite",className:"jsx-33a132a3ce0f70f1"}),(0,t.jsx)("animate",{attributeName:"stroke-dashoffset",dur:"2s",values:"0;-15.708;-31.416",repeatCount:"indefinite",className:"jsx-33a132a3ce0f70f1"})]})}),"Analyzing..."]}),e.error&&(0,t.jsx)("button",{onClick:()=>retryAnalysis(a),title:"Retry analysis",className:"jsx-33a132a3ce0f70f1 retry-button",children:"↻"}),(0,t.jsx)("button",{onClick:()=>removeFile(a),title:"Remove file",className:"jsx-33a132a3ce0f70f1 remove-button",children:"✕"})]})]}),e.error&&(0,t.jsx)("div",{className:"jsx-33a132a3ce0f70f1 file-error",children:(0,t.jsxs)("span",{className:"jsx-33a132a3ce0f70f1",children:["❌ Analysis failed: ",e.error]})}),e.analysis&&(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-results",children:[(0,t.jsx)("div",{className:"jsx-33a132a3ce0f70f1 analysis-header",children:(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1 analysis-success",children:"✅ Analysis Complete"})}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-grid",children:[(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-card",children:[(0,t.jsx)("h5",{className:"jsx-33a132a3ce0f70f1",children:"File Information"}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-row",children:[(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:"Type:"}),(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:e.analysis.file_type})]}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-row",children:[(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:"Size:"}),(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:formatFileSize(e.analysis.file_size)})]}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-row",children:[(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:"Estimated Chunks:"}),(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:e.analysis.estimated_chunks.toLocaleString()})]}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-row",children:[(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:"Processing Time:"}),(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:formatProcessingTime(e.analysis.processing_time_estimate)})]})]}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-card",children:[(0,t.jsx)("h5",{className:"jsx-33a132a3ce0f70f1",children:"Content Analysis"}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-row",children:[(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:"Language:"}),(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:e.analysis.content_analysis.language})]}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-row",children:[(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:"Text Content:"}),(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:e.analysis.content_analysis.text_content?"✅":"❌"})]}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-row",children:[(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:"Has Tables:"}),(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:e.analysis.content_analysis.has_tables?"✅":"❌"})]}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-row",children:[(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:"Has Images:"}),(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:e.analysis.content_analysis.has_images?"✅":"❌"})]}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-row",children:[(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:"Complexity Score:"}),(0,t.jsxs)("span",{className:"jsx-33a132a3ce0f70f1",children:[e.analysis.content_analysis.complexity_score,"/10"]})]})]}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-card",children:[(0,t.jsx)("h5",{className:"jsx-33a132a3ce0f70f1",children:"Recommended Settings"}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-row",children:[(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:"Chunk Size:"}),(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:e.analysis.recommended_settings.chunk_size.toLocaleString()})]}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-row",children:[(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:"Chunk Overlap:"}),(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:e.analysis.recommended_settings.chunk_overlap.toLocaleString()})]}),(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 analysis-row",children:[(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1",children:"Processing Mode:"}),(0,t.jsx)("span",{className:"jsx-33a132a3ce0f70f1 "+"mode-badge ".concat(e.analysis.recommended_settings.processing_mode),children:e.analysis.recommended_settings.processing_mode})]})]})]})]})]},a))})]}),0===l.length&&(0,t.jsxs)("div",{className:"jsx-33a132a3ce0f70f1 empty-state",children:[(0,t.jsx)("div",{className:"jsx-33a132a3ce0f70f1 empty-icon",children:"\uD83D\uDCC4"}),(0,t.jsx)("h4",{className:"jsx-33a132a3ce0f70f1",children:"No files uploaded yet"}),(0,t.jsx)("p",{className:"jsx-33a132a3ce0f70f1",children:"Upload your first document to see analysis results and processing recommendations."})]})]}),(0,t.jsx)(n(),{id:"33a132a3ce0f70f1",children:".file-analysis-page.jsx-33a132a3ce0f70f1{max-width:900px;margin:0 auto}.intro-section.jsx-33a132a3ce0f70f1{margin-bottom:2rem}.intro-section.jsx-33a132a3ce0f70f1 h3.jsx-33a132a3ce0f70f1{margin:0 0 .5rem 0;font-size:1.5rem;font-weight:600}.intro-section.jsx-33a132a3ce0f70f1 p.jsx-33a132a3ce0f70f1{color:rgba(255,255,255,.7);margin:0;line-height:1.6}.upload-area.jsx-33a132a3ce0f70f1{border:2px dashed rgba(255,255,255,.3);-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;padding:3rem 2rem;text-align:center;cursor:pointer;-webkit-transition:all.3s ease;-moz-transition:all.3s ease;-o-transition:all.3s ease;transition:all.3s ease;margin-bottom:2rem;background:rgba(255,255,255,.02)}.upload-area.jsx-33a132a3ce0f70f1:hover,.upload-area.drag-over.jsx-33a132a3ce0f70f1{border-color:#007bff;background:rgba(0,123,255,.05);-webkit-transform:translatey(-2px);-moz-transform:translatey(-2px);-ms-transform:translatey(-2px);-o-transform:translatey(-2px);transform:translatey(-2px)}.upload-icon.jsx-33a132a3ce0f70f1{font-size:3rem;margin-bottom:1rem}.upload-area.jsx-33a132a3ce0f70f1 h4.jsx-33a132a3ce0f70f1{margin:0 0 .5rem 0;font-weight:600;color:#fff}.upload-area.jsx-33a132a3ce0f70f1 p.jsx-33a132a3ce0f70f1{color:rgba(255,255,255,.7);margin:0;font-size:.875rem}.files-section.jsx-33a132a3ce0f70f1{margin-bottom:2rem}.files-section.jsx-33a132a3ce0f70f1 h4.jsx-33a132a3ce0f70f1{margin:0 0 1.5rem 0;font-weight:600;color:#fff}.files-list.jsx-33a132a3ce0f70f1{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:1.5rem}.file-item.jsx-33a132a3ce0f70f1{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;padding:1.5rem}.file-header.jsx-33a132a3ce0f70f1{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;margin-bottom:1rem}.file-info.jsx-33a132a3ce0f70f1{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1}.file-name.jsx-33a132a3ce0f70f1{font-weight:600;color:#fff;margin-bottom:.25rem}.file-meta.jsx-33a132a3ce0f70f1{color:rgba(255,255,255,.6);font-size:.875rem}.file-actions.jsx-33a132a3ce0f70f1{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:.75rem}.analyzing-indicator.jsx-33a132a3ce0f70f1{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:.5rem;color:#007bff;font-size:.875rem}.spinner.jsx-33a132a3ce0f70f1{width:16px;height:16px}.retry-button.jsx-33a132a3ce0f70f1,.remove-button.jsx-33a132a3ce0f70f1{width:32px;height:32px;border:none;-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;cursor:pointer;display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-moz-box-pack:center;-ms-flex-pack:center;justify-content:center;font-size:.875rem;-webkit-transition:all.2s ease;-moz-transition:all.2s ease;-o-transition:all.2s ease;transition:all.2s ease}.retry-button.jsx-33a132a3ce0f70f1{background:rgba(59,130,246,.2);color:#93c5fd}.retry-button.jsx-33a132a3ce0f70f1:hover{background:rgba(59,130,246,.3)}.remove-button.jsx-33a132a3ce0f70f1{background:rgba(239,68,68,.2);color:#fca5a5}.remove-button.jsx-33a132a3ce0f70f1:hover{background:rgba(239,68,68,.3)}.file-error.jsx-33a132a3ce0f70f1{background:rgba(239,68,68,.1);border:1px solid rgba(239,68,68,.3);-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;padding:.75rem;margin-bottom:1rem;color:#fca5a5;font-size:.875rem}.analysis-results.jsx-33a132a3ce0f70f1{border-top:1px solid rgba(255,255,255,.1);padding-top:1rem}.analysis-header.jsx-33a132a3ce0f70f1{margin-bottom:1rem}.analysis-success.jsx-33a132a3ce0f70f1{color:#6ee7b7;font-weight:600;font-size:.875rem}.analysis-grid.jsx-33a132a3ce0f70f1{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem}.analysis-card.jsx-33a132a3ce0f70f1{background:rgba(255,255,255,.05);border:1px solid rgba(255,255,255,.1);-webkit-border-radius:8px;-moz-border-radius:8px;border-radius:8px;padding:1rem}.analysis-card.jsx-33a132a3ce0f70f1 h5.jsx-33a132a3ce0f70f1{margin:0 0 1rem 0;font-weight:600;color:#fff;font-size:.875rem}.analysis-row.jsx-33a132a3ce0f70f1{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;-moz-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:.5rem;font-size:.875rem}.analysis-row.jsx-33a132a3ce0f70f1:last-child{margin-bottom:0}.analysis-row.jsx-33a132a3ce0f70f1 span.jsx-33a132a3ce0f70f1:first-child{color:rgba(255,255,255,.7)}.analysis-row.jsx-33a132a3ce0f70f1 span.jsx-33a132a3ce0f70f1:last-child{color:#fff;font-weight:500}.mode-badge.jsx-33a132a3ce0f70f1{padding:.25rem .5rem;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;font-size:.75rem;font-weight:600}.mode-badge.streaming.jsx-33a132a3ce0f70f1{background:rgba(16,185,129,.2);color:#6ee7b7}.mode-badge.async.jsx-33a132a3ce0f70f1{background:rgba(59,130,246,.2);color:#93c5fd}.empty-state.jsx-33a132a3ce0f70f1{text-align:center;padding:3rem 2rem;color:rgba(255,255,255,.6)}.empty-icon.jsx-33a132a3ce0f70f1{font-size:4rem;margin-bottom:1rem}.empty-state.jsx-33a132a3ce0f70f1 h4.jsx-33a132a3ce0f70f1{margin:0 0 .5rem 0;color:rgba(255,255,255,.8)}.empty-state.jsx-33a132a3ce0f70f1 p.jsx-33a132a3ce0f70f1{margin:0}@media(max-width:768px){.file-header.jsx-33a132a3ce0f70f1{-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-moz-box-orient:vertical;-moz-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-align:start;-webkit-align-items:flex-start;-moz-box-align:start;-ms-flex-align:start;align-items:flex-start;gap:1rem}.file-actions.jsx-33a132a3ce0f70f1{-webkit-align-self:flex-end;-ms-flex-item-align:end;align-self:flex-end}.analysis-grid.jsx-33a132a3ce0f70f1{grid-template-columns:1fr}.upload-area.jsx-33a132a3ce0f70f1{padding:2rem 1rem}}"})]})]})}},1163:function(e,a,s){e.exports=s(9974)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=5280)}),_N_E=e.O()}]);